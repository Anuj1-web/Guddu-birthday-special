<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Guddu‚Äôs Birthday City üéÇüèôÔ∏è</title>
  <style>
    body { margin: 0; overflow: hidden; background: #000; }
    canvas { display: block; }
    #message {
      position: absolute;
      top: 20px; left: 50%;
      transform: translateX(-50%);
      padding: 15px 25px;
      background: rgba(0,0,0,0.7);
      color: #fff; font-size: 20px;
      border-radius: 10px;
      display: none;
    }
    /* Mobile joystick */
    #joystick {
      position: absolute;
      bottom: 50px; left: 50px;
      width: 100px; height: 100px;
      border: 2px solid #fff; border-radius: 50%;
      background: rgba(255,255,255,0.1);
      touch-action: none;
    }
    #stick {
      width: 50px; height: 50px;
      background: rgba(255,255,255,0.5);
      border-radius: 50%; position: absolute;
      top: 25px; left: 25px;
    }
  </style>
</head>
<body>
  <div id="message"></div>
  <div id="joystick"><div id="stick"></div></div>
  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/examples/js/controls/PointerLockControls.js"></script>
  <script>
    // === SCENE SETUP ===
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 2000);
    const renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // === LIGHTING ===
    const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 1);
    hemiLight.position.set(0,200,0);
    scene.add(hemiLight);

    const dirLight = new THREE.DirectionalLight(0xffffff, 1);
    dirLight.position.set(-100, 200, 100);
    scene.add(dirLight);

    // === GROUND ===
    const groundGeo = new THREE.PlaneGeometry(500,500);
    const groundMat = new THREE.MeshPhongMaterial({color:0x444444});
    const ground = new THREE.Mesh(groundGeo, groundMat);
    ground.rotation.x = -Math.PI/2;
    scene.add(ground);

    // === BUILDINGS ===
    for(let i=0;i<40;i++){
      const geo = new THREE.BoxGeometry(20,Math.random()*100+40,20);
      const mat = new THREE.MeshPhongMaterial({color:0x222222, emissive:0x111111});
      const b = new THREE.Mesh(geo, mat);
      b.position.set((Math.random()-0.5)*400, geo.parameters.height/2, (Math.random()-0.5)*400);
      scene.add(b);
    }

    // === PLAYER CONTROLS ===
    const controls = new THREE.PointerLockControls(camera, renderer.domElement);
    document.body.addEventListener('click', ()=>controls.lock());
    camera.position.set(0,10,50);

    // Movement
    let move = {forward:0,back:0,left:0,right:0};
    const onKeyDown = e => {
      if(e.code==="ArrowUp"||e.code==="KeyW") move.forward=1;
      if(e.code==="ArrowDown"||e.code==="KeyS") move.back=1;
      if(e.code==="ArrowLeft"||e.code==="KeyA") move.left=1;
      if(e.code==="ArrowRight"||e.code==="KeyD") move.right=1;
    }
    const onKeyUp = e => {
      if(e.code==="ArrowUp"||e.code==="KeyW") move.forward=0;
      if(e.code==="ArrowDown"||e.code==="KeyS") move.back=0;
      if(e.code==="ArrowLeft"||e.code==="KeyA") move.left=0;
      if(e.code==="ArrowRight"||e.code==="KeyD") move.right=0;
    }
    document.addEventListener('keydown', onKeyDown);
    document.addEventListener('keyup', onKeyUp);

    // === HOARDINGS WITH SLIDESHOW ===
    const loader = new THREE.TextureLoader();
    const imageFiles = [
      "IMG-20250304-WA0006.jpg",
      "IMG-20250304-WA0010.jpg",
      "IMG-20250304-WA0011.jpg",
      "IMG-20250815-WA0000.jpg",
      "IMG-20250815-WA0001.jpg",
      "IMG-20250815-WA0003.jpg",
      "IMG-20250815-WA0008.jpg",
      "IMG-20250815-WA0009.jpg",
      "IMG-20250815-WA0010.jpg",
      "IMG-20250815-WA0011.jpg"
    ];
    let currentSlide=0;
    const hoardings=[];
    for(let i=0;i<5;i++){
      const mat = new THREE.MeshBasicMaterial({map:loader.load(imageFiles[currentSlide])});
      const geo = new THREE.PlaneGeometry(40,25);
      const mesh = new THREE.Mesh(geo, mat);
      mesh.position.set(i*80-160,30,-100);
      scene.add(mesh);
      hoardings.push(mat);
    }
    setInterval(()=>{
      currentSlide=(currentSlide+1)%imageFiles.length;
      hoardings.forEach(mat=>mat.map=loader.load(imageFiles[currentSlide]));
    },3000);

    // === BALLOONS & BUTTERFLIES ===
    const balloons=[];
    for(let i=0;i<10;i++){
      const geo=new THREE.SphereGeometry(3,16,16);
      const mat=new THREE.MeshPhongMaterial({color:0xff0000});
      const b=new THREE.Mesh(geo,mat);
      b.position.set((Math.random()-0.5)*200,30+Math.random()*20,(Math.random()-0.5)*200);
      scene.add(b); balloons.push(b);
    }

    // === GIFTS ===
    const gifts=[];
    for(let i=0;i<6;i++){
      const geo=new THREE.BoxGeometry(5,5,5);
      const mat=new THREE.MeshPhongMaterial({color:0xffd700});
      const g=new THREE.Mesh(geo,mat);
      g.position.set((Math.random()-0.5)*200,2.5,(Math.random()-0.5)*200);
      scene.add(g); gifts.push(g);
    }
    const msg=document.getElementById("message");

    // === RENDER LOOP ===
    function animate(){
      requestAnimationFrame(animate);

      // Balloons float
      balloons.forEach(b=>{ b.position.y+=Math.sin(Date.now()*0.001)*0.01; });

      // Movement
      const speed=0.5;
      if(move.forward) controls.moveForward(speed);
      if(move.back) controls.moveForward(-speed);
      if(move.left) controls.moveRight(-speed);
      if(move.right) controls.moveRight(speed);

      // Gift collection
      gifts.forEach((g,i)=>{
        if(g.visible){
          const dist=camera.position.distanceTo(g.position);
          if(dist<10){
            msg.innerText="üéÅ Happy Birthday Guddu ‚ù§Ô∏è";
            msg.style.display="block";
            setTimeout(()=>msg.style.display="none",2000);
            g.visible=false;
          }
        }
      });

      renderer.render(scene,camera);
    }
    animate();

    window.addEventListener('resize',()=>{
      camera.aspect=window.innerWidth/window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
