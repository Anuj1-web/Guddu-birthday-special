<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Guddu's City Game</title>
  <style>
    body { margin: 0; overflow: hidden; font-family: sans-serif; }
    canvas { display: block; }
    #controls {
      position: absolute; bottom: 20px; right: 20px; z-index: 10;
      display: flex; flex-direction: column; gap: 10px;
    }
    .btn {
      width: 50px; height: 50px; border-radius: 50%;
      background: rgba(255,255,255,0.6); border: 2px solid #333;
      display: flex; align-items: center; justify-content: center;
      font-size: 20px; cursor: pointer; user-select: none;
    }
  </style>
</head>
<body>
  <div id="controls">
    <div class="btn" id="up">↑</div>
    <div style="display:flex; gap:10px;">
      <div class="btn" id="left">←</div>
      <div class="btn" id="down">↓</div>
      <div class="btn" id="right">→</div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/examples/js/controls/OrbitControls.js"></script>

  <script>
    let scene = new THREE.Scene();
    let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    let renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Lights
    let ambient = new THREE.AmbientLight(0xffffff, 0.6);
    scene.add(ambient);
    let dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
    dirLight.position.set(5,10,7);
    scene.add(dirLight);

    // Ground
    let groundGeo = new THREE.PlaneGeometry(200,200);
    let groundMat = new THREE.MeshPhongMaterial({color:0x444444});
    let ground = new THREE.Mesh(groundGeo, groundMat);
    ground.rotation.x = -Math.PI/2;
    scene.add(ground);

    // Simple buildings
    function addBuilding(x,z){
      let h = 5+Math.random()*10;
      let geo = new THREE.BoxGeometry(5,h,5);
      let mat = new THREE.MeshPhongMaterial({color:0x8888ff});
      let mesh = new THREE.Mesh(geo, mat);
      mesh.position.set(x,h/2,z);
      scene.add(mesh);
    }
    for(let i=-50;i<=50;i+=15){
      for(let j=-50;j<=50;j+=15){
        if(Math.random()>0.7) addBuilding(i,j);
      }
    }

    // Hoardings with slideshow
    const imagePaths = [
      "IMG-20250304-WA0006.jpg",
      "IMG-20250304-WA0010.jpg",
      "IMG-20250304-WA0011.jpg",
      "IMG-20250815-WA0000.jpg",
      "IMG-20250815-WA0001.jpg",
      "IMG-20250815-WA0003.jpg",
      "IMG-20250815-WA0008.jpg",
      "IMG-20250815-WA0009.jpg",
      "IMG-20250815-WA0010.jpg",
      "IMG-20250815-WA0011.jpg"
    ];

    let hoardings = [];
    function createHoarding(x,z){
      let geo = new THREE.PlaneGeometry(12,6);
      let mat = new THREE.MeshBasicMaterial({map:null, side:THREE.DoubleSide});
      let mesh = new THREE.Mesh(geo,mat);
      mesh.position.set(x,5,z);
      scene.add(mesh);
      hoardings.push({mesh:mesh, idx:0});
    }

    createHoarding(0,-20);
    createHoarding(20,0);
    createHoarding(-20,0);
    createHoarding(0,20);
    createHoarding(30,30);

    let loader = new THREE.TextureLoader();
    function updateHoardings(){
      hoardings.forEach(h=>{
        h.idx = (h.idx+1) % imagePaths.length;
        loader.load(imagePaths[h.idx], tex=>{
          h.mesh.material.map = tex;
          h.mesh.material.needsUpdate = true;
        });
      });
    }
    setInterval(updateHoardings, 3000); // every 3s switch

    // Floating balloons (simple spheres)
    let balloons = [];
    for(let i=0;i<10;i++){
      let geo = new THREE.SphereGeometry(1,16,16);
      let mat = new THREE.MeshPhongMaterial({color:0xff6666});
      let s = new THREE.Mesh(geo,mat);
      s.position.set(Math.random()*80-40, 3+Math.random()*5, Math.random()*80-40);
      scene.add(s);
      balloons.push(s);
    }

    // Player movement
    let player = new THREE.Object3D();
    scene.add(player);
    camera.position.set(0,2,5);
    player.add(camera);

    let keys = {};
    document.addEventListener("keydown",e=>keys[e.key]=true);
    document.addEventListener("keyup",e=>keys[e.key]=false);

    // Mobile controls
    const btns = {up:false,down:false,left:false,right:false};
    document.getElementById("up").ontouchstart=()=>btns.up=true;
    document.getElementById("up").ontouchend=()=>btns.up=false;
    document.getElementById("down").ontouchstart=()=>btns.down=true;
    document.getElementById("down").ontouchend=()=>btns.down=false;
    document.getElementById("left").ontouchstart=()=>btns.left=true;
    document.getElementById("left").ontouchend=()=>btns.left=false;
    document.getElementById("right").ontouchstart=()=>btns.right=true;
    document.getElementById("right").ontouchend=()=>btns.right=false;

    // Animate
    let clock = new THREE.Clock();
    function animate(){
      requestAnimationFrame(animate);

      // Movement
      let speed = 0.2;
      if(keys["w"]||keys["ArrowUp"]||btns.up) player.position.z -= speed;
      if(keys["s"]||keys["ArrowDown"]||btns.down) player.position.z += speed;
      if(keys["a"]||keys["ArrowLeft"]||btns.left) player.position.x -= speed;
      if(keys["d"]||keys["ArrowRight"]||btns.right) player.position.x += speed;

      // Balloons floating
      balloons.forEach(b=>{
        b.position.y += 0.01*Math.sin(clock.getElapsedTime());
      });

      // Day-night cycle
      let t = (clock.getElapsedTime()*0.02) % 1;
      let col = new THREE.Color().setHSL(0.6, 0.5, t*0.5+0.25);
      renderer.setClearColor(col);

      renderer.render(scene,camera);
    }
    animate();

    window.addEventListener("resize",()=>{
      camera.aspect=window.innerWidth/window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth,window.innerHeight);
    });
  </script>
</body>
</html>
