<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Birthday, Guddu! ğŸ‚ğŸ’–</title>
  <meta name="description" content="A lovingly crafted birthday surprise for Gudduâ€”messages, memories, photos, videos, and lots of sparkle."/>
  <meta property="og:title" content="Happy Birthday, Guddu!"/>
  <meta property="og:description" content="Open me, Guddu! A birthday site made with love."/>
  <meta property="og:type" content="website"/>
  <meta property="og:image" content="assets/cover.jpg"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&family=Great+Vibes&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: radial-gradient(1200px 800px at 10% 10%, #ffe6f2 0%, #fff 55%, #fff 100%);
      --text:#1a1a1a;
      --muted:#666;
      --primary:#ff3d77; /* pink */
      --accent:#7c4dff;  /* purple */
      --gold:#ffb800;
      --card:#ffffffeb;
      --shadow: 0 10px 30px rgba(0,0,0,.07);
    }
    [data-theme="dark"]{
      --bg: radial-gradient(1200px 800px at 10% 10%, #2a1730 0%, #0f0b12 55%, #0f0b12 100%);
      --text:#f3f3f3; --muted:#b7b7b7; --card:#16131aeb; --shadow: 0 10px 30px rgba(0,0,0,.5);
      --primary:#ff5b8a; --accent:#9d7cff; --gold:#ffd45e;
    }
    *{box-sizing:border-box}
    html,body{margin:0}
    body{
      font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--text); background:var(--bg); min-height:100vh;
      overflow-x:hidden;
    }
    /* Header */
    header{
      position:sticky; top:0; z-index:50; backdrop-filter:saturate(180%) blur(8px);
      background:linear-gradient(180deg, rgba(255,255,255,.65), rgba(255,255,255,.25));
      border-bottom:1px solid rgba(0,0,0,.06);
    }
    [data-theme="dark"] header{background:linear-gradient(180deg, rgba(22,19,26,.65), rgba(22,19,26,.25)); border-color:rgba(255,255,255,.06)}
    .wrap{max-width:1100px; margin:0 auto; padding:14px 18px;}
    .nav{display:flex; align-items:center; gap:14px;}
    .brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--text)}
    .brand .logo{width:36px; height:36px; border-radius:50%; background:conic-gradient(from 90deg, var(--primary), var(--accent)); box-shadow:0 6px 16px rgba(124,77,255,.35)}
    .brand span{font-weight:800; letter-spacing:.3px}
    .spacer{flex:1}
    .btn, button.btn{appearance:none; border:0; padding:10px 14px; border-radius:14px; cursor:pointer; font-weight:600; box-shadow:var(--shadow); transition:transform .12s ease, box-shadow .2s ease; text-decoration:none; display:inline-flex; align-items:center; gap:8px}
    .btn-primary{background:linear-gradient(135deg, var(--primary), var(--accent)); color:#fff}
    .btn-ghost{background:var(--card); color:var(--text);}
    .btn:hover{transform:translateY(-1px)}

    /* Hero */
    .hero{position:relative; padding:80px 18px 40px}
    .hero h1{font-size:clamp(36px, 5vw, 64px); line-height:1.05; margin:0 0 10px; font-weight:800}
    .script{font-family:"Great Vibes", cursive; font-size:clamp(28px, 4vw, 48px); color:var(--primary); filter:drop-shadow(0 8px 18px rgba(255,61,119,.2));}
    .tag{color:var(--muted); font-weight:400}

    .sparkles{position:absolute; inset:0; pointer-events:none}

    /* Sections */
    section{scroll-margin-top:90px}
    .section{padding:32px 18px}
    .grid{display:grid; gap:18px}
    .grid.cards{grid-template-columns:repeat(auto-fit, minmax(240px, 1fr))}
    .card{background:var(--card); border-radius:22px; padding:18px; box-shadow:var(--shadow)}
    .card h3{margin:6px 0 10px}
    .muted{color:var(--muted)}

    /* Gallery */
    .gallery{display:grid; grid-template-columns:repeat(auto-fit, minmax(220px,1fr)); gap:12px}
    .media{position:relative; border-radius:18px; overflow:hidden; box-shadow:var(--shadow)}
    .media img, .media video{width:100%; height:260px; object-fit:cover; display:block}
    .media .cap{position:absolute; left:0; right:0; bottom:0; padding:10px 12px; background:linear-gradient(180deg, transparent, rgba(0,0,0,.45)); color:#fff; font-size:14px}

    /* Message cards (variety) */
    .gcard{position:relative; border-radius:22px; padding:20px; overflow:hidden; box-shadow:var(--shadow); color:#fff}
    .gcard h4{margin:0 0 8px}
    .gcard p{margin:0}
    .gcard.glow::before{content:""; position:absolute; inset:-2px; background:conic-gradient(var(--primary), var(--accent), var(--gold), var(--primary)); filter:blur(16px); opacity:.45}
    .gcard.glow > *{position:relative}
    .gcard.soft{background:linear-gradient(135deg, #ff6fa1, #7c4dff)}
    .gcard.sunset{background:linear-gradient(135deg, #ffb347, #ff3d77)}
    .gcard.ocean{background:linear-gradient(135deg, #38bdf8, #7c4dff)}

    /* Timeline */
    .timeline{position:relative; margin:10px 0}
    .timeline::before{content:""; position:absolute; left:12px; top:0; bottom:0; width:3px; background:linear-gradient(var(--accent), var(--primary))}
    .titem{display:grid; grid-template-columns:28px 1fr; gap:12px; align-items:start; margin:12px 0}
    .dot{width:24px; height:24px; border-radius:50%; background:linear-gradient(135deg, var(--primary), var(--accent)); box-shadow:0 6px 14px rgba(0,0,0,.2)}
    .tcontent{background:var(--card); padding:12px 14px; border-radius:16px; box-shadow:var(--shadow)}

    /* Footer */
    footer{padding:60px 18px; text-align:center; color:var(--muted)}

    /* Floating hearts */
    .float-heart{position:fixed; pointer-events:none; z-index:9999; font-size:18px; animation:floatUp 3.5s ease-in forwards}
    @keyframes floatUp{0%{opacity:0; transform:translateY(0) scale(.8)} 10%{opacity:1} 100%{opacity:0; transform:translateY(-160px) scale(1.6)}}

    /* Modal music prompt */
    .modal{position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.45); z-index:60}
    .modal .dialog{background:var(--card); padding:20px; border-radius:18px; text-align:center; box-shadow:var(--shadow)}

    /* Utility */
    .center{display:flex; align-items:center; justify-content:center}
    .row{display:flex; gap:10px; flex-wrap:wrap}
    .hidden{display:none}
    .mt-2{margin-top:8px} .mt-3{margin-top:14px} .mt-4{margin-top:22px}

    /* Professional birthday reveal bits */
    .headline-gold{
      background:linear-gradient(90deg,#ffb800,#ff6fa1,#7c4dff,#ffb800);
      -webkit-background-clip:text;background-clip:text;color:transparent;
      font-weight:800; letter-spacing:.5px; filter:drop-shadow(0 6px 16px rgba(124,77,255,.25));
      animation:shine 3.2s linear infinite;
    }
    @keyframes shine{
      0%{background-position:0% 50%}100%{background-position:200% 50%}
    }

    /* Lock cards until reveal */
    #cards{
      transition:opacity .6s ease, transform .6s ease;
    }
    #cards.locked{
      opacity:.0; transform:translateY(10px); pointer-events:none;
    }

    /* Reduce motion */
    @media (prefers-reduced-motion: reduce){
      .btn, .headline-gold{animation:none}
      .float-heart{animation:none}
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap nav">
      <a class="brand" href="#top" aria-label="home">
        <span class="logo" aria-hidden="true"></span>
        <span>Guddu's Day</span>
      </a>
      <div class="spacer"></div>
      <a class="btn btn-ghost" href="#welcome">Welcome</a>
      <a class="btn btn-ghost" href="#messages">Messages</a>
      <a class="btn btn-ghost" href="#gallery">Photos & Videos</a>
      <a class="btn btn-ghost" href="#cards">Greeting Cards</a>
      <button id="themeBtn" class="btn btn-ghost" aria-label="Toggle theme">ğŸŒ“</button>
      <button id="confettiBtn" class="btn btn-primary" aria-label="Confetti">ğŸ‰ Celebrate</button>
    </div>
  </header>

  <!-- HERO / WELCOME -->
  <main id="top" class="hero wrap">
    <canvas id="sparkleCanvas" class="sparkles" aria-hidden="true"></canvas>
    <h1><span class="script">Happy Birthday,</span><br> dearest <span id="friendName">Guddu</span>! ğŸŒ¸</h1>
    <p class="tag">Today is all about you. May your smile outshine the stars, your dreams soar high, and your heart stay forever happy. â€” With love, <span id="yourName">Your Friend</span> ğŸ’–</p>
    <div class="row mt-3">
      <a href="#messages" class="btn btn-primary">Read My Wishes âœ¨</a>
      <a href="#gallery" class="btn btn-ghost">Memories Gallery ğŸ“·</a>
      <button id="musicBtn" class="btn btn-ghost">â–¶ï¸ Play Birthday Tune</button>
    </div>
  </main>

  <!-- WELCOME SECTION -->
  <section id="welcome" class="section wrap">
    <div class="grid cards">
      <article class="card">
        <h3>To My Favorite Person, <span class="script" style="font-size:1.4em">Guddu</span> ğŸ€</h3>
        <p class="muted">On your special day, I built this little corner of the internet so you can feel just how cherished you are. Scroll down for surprises, memories, and love-filled messages, all for you. ğŸ’«</p>
        <div class="mt-3 row">
          <button class="btn btn-primary" onclick="burstHearts()">Send Hearts ğŸ’—</button>
          <button class="btn btn-ghost" onclick="typeOutMessage()">Reveal a Secret âœï¸</button>
        </div>
      </article>
      <article class="card">
        <h3>Countdown to 28 Aug â³</h3>
        <p class="muted">Tick-tock to midnight magic (12:00 AM, 28 Aug). When it hits zero, surprises appear.</p>
        <div id="countdown" class="mt-3" aria-live="polite" style="font-weight:800; font-size:24px"></div>
      </article>
      <article class="card">
        <h3>Birthday Tune ğŸµ</h3>
        <p class="muted">Tap play to start the music. (Browsers block auto-play with sound.)</p>
        <audio id="song" src="assets/hbd.mp3" preload="auto" controls class="mt-2" aria-label="Birthday song"></audio>
      </article>
    </div>
  </section>

  <!-- MESSAGES -->
  <section id="messages" class="section wrap">
    <h2 class="script" style="font-size:40px; margin:0 0 12px">Wishes & Words</h2>
    <div class="grid cards">
      <article class="gcard soft">
        <h4>For Your Heart</h4>
        <p>May your days be soft as sunrise and bright as your smile. You make ordinary moments feel like magic. Keep shining, Guddu! âœ¨</p>
      </article>
      <article class="gcard sunset">
        <h4>For Your Dreams</h4>
        <p>I believe in youâ€”today, tomorrow, always. May every wish you whisper today start a beautiful new chapter. ğŸŒ…</p>
      </article>
      <article class="gcard ocean">
        <h4>For Your Laugh</h4>
        <p>Your laughter is my favorite sound. Remembering about you always gives me a inner smile. ğŸŒŠ</p>
      </article>
      <article class="gcard glow">
        <h4>Promise</h4>
        <p>Iâ€™ll be right hereâ€”cheering for you, celebrating you, and reminding you how special you are. ğŸ’«</p>
      </article>
    </div>

    <div class="card mt-4">
      <h3>Mini Memory Timeline â±ï¸</h3>
      <div class="timeline">
        <div class="titem"><span class="dot"></span><div class="tcontent"><strong>First hello</strong> â€” The day the world got better for me. ğŸŒŸ</div></div>
        <div class="titem"><span class="dot"></span><div class="tcontent"><strong>First Face to Face meeting</strong> â€” The best day for me.ğŸ’«</div></div>
        <div class="titem"><span class="dot"></span><div class="tcontent"><strong>Today</strong> â€” A whole website just for you. ğŸ</div></div>
      </div>
    </div>
  </section>

  <!-- GALLERY -->
  <section id="gallery" class="section wrap">
    <h2 class="script" style="font-size:40px; margin:0 0 12px">Photos & Videos</h2>
    <p class="muted">Replace the media files in <code>assets/</code> and captions below with your real memories. (Examples shown.)</p>
    <div class="gallery mt-3">
      <!-- IMAGES -->
      <figure class="media"><img src="assets/guddu-1.jpg" alt="Guddu smiling"><figcaption class="cap">That sunshine smile â˜€ï¸</figcaption></figure>
      <figure class="media"><img src="assets/guddu-2.jpg" alt="Birthday vibes"><figcaption class="cap">Pre-birthday glow âœ¨</figcaption></figure>
      <figure class="media"><img src="assets/guddu-3.jpg" alt="Candid moment"><figcaption class="cap">My favorite candid ğŸ“¸</figcaption></figure>
      <!-- VIDEO -->
      <figure class="media"><video src="assets/guddu-video.mp4" controls poster="assets/guddu-cover.jpg"></video><figcaption class="cap">A little video memory ğŸ¥</figcaption></figure>
    </div>
  </section>

  <!-- GREETING CARDS -->
  <section id="cards" class="section wrap locked">
    <h2 class="script" style="font-size:40px; margin:0 0 12px">Open Your Cards ğŸ’Œ</h2>
    <div class="grid cards">
      <article class="card">
        <h3>Classic Card</h3>
        <p class="muted">A simple, elegant wish you can screenshot or share.</p>
        <div class="center mt-3" style="padding:10px">
          <div id="cardClassic" style="width:100%; max-width:420px; aspect-ratio:4/5; border-radius:22px; background:linear-gradient(135deg, #ffe8f1, #e9ddff); display:flex; align-items:center; justify-content:center; text-align:center; padding:18px; position:relative; box-shadow:var(--shadow)">
            <div style="position:absolute; inset:12px; border:2px dashed rgba(0,0,0,.1); border-radius:18px"></div>
            <div>
              <div style="font-family:'Great Vibes', cursive; font-size:42px; color:#ff3d77">Happy Birthday</div>
              <div style="font-weight:800; font-size:28px; letter-spacing:.3px; margin-top:6px" id="nameOnCard">Guddu</div>
              <p style="color:#6b6b6b; margin:10px 0 0">You are a blessing, today and always. ğŸ’–</p>
            </div>
          </div>
        </div>
        <div class="row mt-3">
          <button class="btn btn-primary" onclick="downloadCard('cardClassic','guddu-card.png')">â¬‡ï¸ Download</button>
          <button class="btn btn-ghost" onclick="randomizePalette()">ğŸ¨ New Colors</button>
        </div>
      </article>

      <article class="card">
        <h3>Confetti Card</h3>
        <p class="muted">Tap to throw confetti and capture the moment.</p>
        <canvas id="cardConfetti" width="600" height="480" style="width:100%; max-width:600px; border-radius:18px; background:linear-gradient(135deg,#fff3d1,#ffe1f1);"></canvas>
        <div class="row mt-3">
          <button class="btn btn-primary" onclick="confettiBurstCanvas()">ğŸŠ Confetti</button>
          <button class="btn btn-ghost" onclick="saveCanvas('cardConfetti','guddu-confetti.png')">â¬‡ï¸ Download</button>
        </div>
      </article>

      <article class="card">
        <h3>Love Letter ğŸ’</h3>
        <p class="muted">Write a custom note and lock it with a sparkle.</p>
        <textarea id="loveNote" rows="5" style="width:100%; border-radius:12px; border:1px solid rgba(0,0,0,.1); padding:12px; background:transparent; color:var(--text)" placeholder="Dear Guddu, ..."></textarea>
        <div class="row mt-3">
          <button class="btn btn-primary" onclick="saveNote()">ğŸ’¾ Save Note</button>
          <button class="btn btn-ghost" onclick="shareLink()">ğŸ”— Share Link</button>
        </div>
        <small class="muted">(We save only in your browser storage; for public sharing, commit this page to GitHub Pages.)</small>
      </article>
    </div>
  </section>

  <footer>
    Made with ğŸ’– by <span id="yourNameFoot">Your Friend Anuj</span>  just for <strong> My dearest Guddu</strong>. <br>
  </footer>

  <!-- Music Modal (for autoplay prompt) -->
  <div id="musicModal" class="modal">
    <div class="dialog">
      <h3>Start the birthday tune?</h3>
      <p class="muted">Tap play to add music to the celebration.</p>
      <div class="mt-3"><button class="btn btn-primary" onclick="playSongAndClose()">â–¶ï¸ Play</button></div>
    </div>
  </div>

  <script>
    /**
     * Quick personalization
     * Change these two values and commit to GitHub Pages.
     */
    const FRIEND_NAME = "Guddu";     // her name
    const YOUR_NAME   = "Your Friend"; // your name shown on site

    // Apply names
    document.querySelectorAll('#friendName, #nameOnCard').forEach(el => el.textContent = FRIEND_NAME);
    document.querySelectorAll('#yourName, #yourNameFoot').forEach(el => el.textContent = YOUR_NAME);

    /** Theme toggle (saved in localStorage) */
    const themeBtn = document.getElementById('themeBtn');
    const current = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    if(current==='dark') document.documentElement.setAttribute('data-theme','dark');
    themeBtn.addEventListener('click',()=>{
      const d = document.documentElement;
      const dark = d.getAttribute('data-theme')==='dark';
      d.setAttribute('data-theme', dark? 'light':'dark');
      localStorage.setItem('theme', dark? 'light':'dark');
    });

    /** Sparkle background in hero */
    const sp = document.getElementById('sparkleCanvas');
    const spx = sp.getContext('2d');
    let particles = [];
    function initSparkles(){
      sp.width = sp.offsetWidth; sp.height = sp.offsetHeight;
      particles = Array.from({length: 60}, () => ({
        x: Math.random()*sp.width, y: Math.random()*sp.height,
        r: Math.random()*2+0.5, s: Math.random()*0.8+0.2,
      }));
    }
    window.addEventListener('resize', initSparkles);
    initSparkles();
    (function loop(){
      spx.clearRect(0,0,sp.width,sp.height);
      particles.forEach(p=>{
        p.y += p.s; if(p.y>sp.height) p.y = -10;
        spx.beginPath(); spx.arc(p.x,p.y,p.r,0,Math.PI*2);
        spx.fillStyle = 'rgba(255,255,255,.7)'; spx.fill();
      });
      requestAnimationFrame(loop);
    })();

    /** Floating hearts burst */
    function burstHearts(){
      for(let i=0;i<16;i++) setTimeout(()=>{
        const span = document.createElement('span');
        span.className='float-heart';
        span.textContent = ['ğŸ’–','ğŸ’—','ğŸ’“','ğŸ’•','ğŸ’'][Math.floor(Math.random()*5)];
        span.style.left = (Math.random()*80+10)+'vw';
        document.body.appendChild(span);
        setTimeout(()=>span.remove(), 3600);
      }, i*80);
    }

    /**
     * Countdown to next 28 Aug 12:00 AM (local time).
     * When it reaches zero:
     *  - Fade out counter, show "Happiest Birthday, Guddu!" with gold gradient
     *  - Fire confetti and hearts
     *  - Unlock and fade-in the Cards section
     *  - Prompt to start music
     */
    const countdownEl = document.getElementById('countdown');
    const cardsSection = document.getElementById('cards');
    function nextAug28Midnight(){
      const now = new Date();
      const year = (now.getMonth()>7 || (now.getMonth()===7 && now.getDate()>=28)) ? now.getFullYear()+1 : now.getFullYear();
      const d = new Date(year, 7, 28, 0, 0, 0, 0); // month index 7 = August
      return d;
    }
    const targetTime = nextAug28Midnight();

    function pad(n){ return n<10 ? '0'+n : n; }
    let countdownTick = null;

    function renderCountdown(){
      const now = new Date();
      const diff = targetTime - now;
      if(diff <= 0){
        onBirthdayStart();
        return;
      }
      const days = Math.floor(diff / 86400000);
      const hours = Math.floor((diff % 86400000) / 3600000);
      const mins = Math.floor((diff % 3600000) / 60000);
      const secs = Math.floor((diff % 60000) / 1000);
      countdownEl.textContent = `${days}d ${pad(hours)}h ${pad(mins)}m ${pad(secs)}s`;
    }

    function onBirthdayStart(){
      if(countdownTick){ clearInterval(countdownTick); countdownTick=null; }
      // Fade out current countdown text
      countdownEl.style.transition = 'opacity .4s ease';
      countdownEl.style.opacity = '0';
      setTimeout(()=>{
        countdownEl.innerHTML = `<span class="headline-gold" style="font-size:26px">ğŸ‰ Happiest Birthday, ${FRIEND_NAME}! ğŸ‰</span>`;
        countdownEl.style.opacity = '1';
        // Party time
        confetti(document.body, 220);
        burstHearts();
        // Unlock cards with a gentle delay
        setTimeout(()=> cardsSection.classList.remove('locked'), 450);
        // Suggest music
        musicModal.style.display='grid';
      }, 420);
    }

    countdownTick = setInterval(renderCountdown, 1000);
    renderCountdown();

    /** Music controls */
    const musicBtn = document.getElementById('musicBtn'); const song = document.getElementById('song');
    const musicModal = document.getElementById('musicModal');
    musicBtn.addEventListener('click', ()=> musicModal.style.display='grid');
    function playSongAndClose(){ song.play(); musicModal.style.display='none'; }

    /** Confetti explosion (page) */
    const confettiBtn = document.getElementById('confettiBtn');
    confettiBtn.addEventListener('click', ()=>{
      confetti(document.body, 180); // page-wide
    });

    /** Typewriter secret message */
    function typeOutMessage(){
      const msg = `Dear ${FRIEND_NAME},\nYou are loved beyond words. Thank you for being you.`;
      let i=0; const box = document.createElement('div');
      box.className='card'; box.style.position='fixed'; box.style.right='16px'; box.style.bottom='16px'; box.style.maxWidth='340px'; box.style.zIndex='70';
      const p = document.createElement('pre'); p.style.margin='0'; p.style.whiteSpace='pre-wrap';
      box.appendChild(p); document.body.appendChild(box);
      const t = setInterval(()=>{ p.textContent = msg.slice(0, ++i); if(i>=msg.length) clearInterval(t); }, 22);
      setTimeout(()=> box.remove(), 9000);
    }

    /** Greeting Card: download as PNG without external libs (using canvas snapshot) */
    function downloadCard(id, filename){
      // draw DOM element onto an offscreen canvas via SVG foreignObject
      const node = document.getElementById(id);
      const { width, height } = node.getBoundingClientRect();
      const svg = new Blob([
        `<?xml version="1.0" standalone="no"?>\n`+
        `<svg xmlns="http://www.w3.org/2000/svg" width="${width}" height="${height}">`+
        `<foreignObject width="100%" height="100%">`+
        new XMLSerializer().serializeToString(node) +
        `</foreignObject></svg>`
      ], {type:'image/svg+xml;charset=utf-8'});
      const url = URL.createObjectURL(svg);
      const img = new Image();
      img.onload = ()=>{
        const canvas = document.createElement('canvas'); canvas.width=width; canvas.height=height;
        const ctx = canvas.getContext('2d'); ctx.fillStyle='#fff'; ctx.fillRect(0,0,width,height); ctx.drawImage(img,0,0);
        URL.revokeObjectURL(url);
        canvas.toBlob(b=>{ const a = document.createElement('a'); a.href=URL.createObjectURL(b); a.download=filename; a.click(); }, 'image/png');
      };
      img.src = url;
    }

    function randomizePalette(){
      const el = document.getElementById('cardClassic');
      const palettes = [
        ['#ffe8f1','#e9ddff'], ['#d1f7ff','#ffe0e9'], ['#fff3d1','#ffdce7'], ['#e8ffe6','#e8f0ff']
      ];
      const p = palettes[Math.floor(Math.random()*palettes.length)];
      el.style.background = `linear-gradient(135deg, ${p[0]}, ${p[1]})`;
    }

    /** Confetti canvas card */
    const cCanvas = document.getElementById('cardConfetti');
    const cctx = cCanvas.getContext('2d');
    function confettiBurstCanvas(){ confetti(cCanvas, 120); }
    function saveCanvas(id, filename){
      const c = document.getElementById(id);
      c.toBlob(b=>{ const a=document.createElement('a'); a.href=URL.createObjectURL(b); a.download=filename; a.click(); }, 'image/png');
    }

    /** Minimal confetti engine (canvas target) */
    function confetti(target, count=160){
      const rect = (target===document.body) ? {left:0, top:0, width:window.innerWidth, height:window.innerHeight} : target.getBoundingClientRect();
      const canvas = document.createElement('canvas');
      canvas.width = rect.width; canvas.height = rect.height; canvas.style.position='fixed'; canvas.style.left=rect.left+'px'; canvas.style.top=rect.top+'px'; canvas.style.pointerEvents='none'; canvas.style.zIndex=80;
      document.body.appendChild(canvas);
      const cx = canvas.getContext('2d');
      const pieces = Array.from({length:count}, ()=>({
        x: Math.random()*canvas.width,
        y: Math.random()*-canvas.height,
        w: Math.random()*8+4,
        h: Math.random()*12+6,
        r: Math.random()*Math.PI,
        s: Math.random()*2+1,
        c: `hsl(${Math.random()*360}, 90%, 60%)`
      }));
      let frame=0;
      (function animate(){
        cx.clearRect(0,0,canvas.width,canvas.height);
        pieces.forEach(p=>{
          p.y += p.s*2.2; p.x += Math.sin(frame/20 + p.r); p.r += 0.03;
          cx.save(); cx.translate(p.x,p.y); cx.rotate(p.r); cx.fillStyle=p.c; cx.fillRect(-p.w/2,-p.h/2,p.w,p.h); cx.restore();
        });
        frame++;
        if(frame<260) requestAnimationFrame(animate); else canvas.remove();
      })();
    }

    /** Save love note locally */
    function saveNote(){ localStorage.setItem('gudduLoveNote', document.getElementById('loveNote').value); alert('Saved on this device!'); }
    document.getElementById('loveNote').value = localStorage.getItem('gudduLoveNote') || '';

    /** Share link with prefilled message */
    function shareLink(){ const text = encodeURIComponent(document.getElementById('loveNote').value || `Happy Birthday, ${FRIEND_NAME}!`); const url = location.origin+location.pathname+`?wish=${text}`; navigator.clipboard.writeText(url); alert('Link copied!'); }
    (function readWishFromURL(){ const wish = new URLSearchParams(location.search).get('wish'); if(wish){ document.getElementById('loveNote').value = decodeURIComponent(wish); } })();
  </script>
</body>
</html>
